/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","hammerjs","promise","ojs/ojjquery-hammer","ojs/ojcomponentcore"],function(b,f,a){b.o={};o_("OffcanvasUtils",b.o,b);b.o.RF="oj-offcanvasEdge";b.o.cn="oj-offcanvas";b.o.SF="oj-mediaQueryListener";b.o.MQ="oj-offcanvasHammer";b.o.kv="selector";b.o.Zu="start";b.o.Yu="end";b.o.vP="top";b.o.aF="bottom";b.o.Wu="displayMode";b.o.Xu="push";b.o.uP="overlay";b.o.o6="modality";b.o.tqa="none";b.o.p6="modal";b.o.kz="_dismissHandler";b.o.vF="_openPromise";b.o.Vu="_closePromise";b.o.lz=
"_glassPane";b.o.hQ="_surrogate";b.o.yF="data-oj-surrogate-id";b.o.A6="oj-offcanvas-outer-wrapper";b.o.VP="oj-offcanvas-open";b.o.Ym="oj-offcanvas-transition";b.o.Z5="oj-offcanvas-glasspane";b.o.CP="oj-offcanvas-glasspane-dim";b.o.uqa="oj-offcanvas-generated";b.o.bla={start:"oj-offcanvas-shift-start",end:"oj-offcanvas-shift-end",top:"oj-offcanvas-shift-down",bottom:"oj-offcanvas-shift-up"};b.o.bca={start:"oj-offcanvas-start",end:"oj-offcanvas-end",top:"oj-offcanvas-top",bottom:"oj-offcanvas-bottom"};
b.o.bda=function(a){a=a[b.o.Wu];a!==b.o.uP&&a!==b.o.Xu&&(a=b.ye.Qk("offcanvas").displayMode);return a};b.o.ri=function(a){return f(a[b.o.kv])};b.o.oK=function(a){return a[b.o.o6]===b.o.p6};b.o.Un=function(a){return a.hasClass(b.o.VP)};b.o.jt=function(a){return a.closest("."+b.o.A6)};b.o.sB=function(a){var c=b.o.ri(a);return a[b.o.Wu]===b.o.Xu?c.parent():c};b.o.BW=function(a){var c=b.o.bla[a];if(!c)throw"Invalid edge: "+a;return c};b.o.ce=function(){return"rtl"===b.v.lm()};b.o.GL=function(a,b){a.css({"-webkit-transform":b,
"-ms-transform":b,transform:b})};b.o.ZC=function(a,c,e){c=c===b.o.Yu;b.o.ce()&&(c=!c);b.o.GL(a,"translate3d("+(c?"-":"")+e+", 0, 0)")};b.o.Tka=function(a,c,e){b.o.GL(a,"translate3d(0, "+(c===b.o.aF?"-":"")+e+", 0)")};b.o.q_=function(a){var c=a.edge;a=b.o.ri(a);c&&c.length||(c=a.hasClass("oj-offcanvas-start")?b.o.Zu:a.hasClass("oj-offcanvas-end")?b.o.Yu:a.hasClass("oj-offcanvas-top")?b.o.vP:a.hasClass("oj-offcanvas-bottom")?b.o.aF:b.o.Zu);f.data(a[0],b.o.RF,c);return c};b.o.NI=function(a){return f.data(a[0],
b.o.RF)};b.o.jD=function(a,c,e){var f=a[b.o.Wu],h=b.o.ri(a),k=b.o.VP,f=f===b.o.uP?b.o.Ym+" oj-offcanvas-overlay":b.o.Ym;e?(e=h.attr("tabIndex"),void 0!==e&&(a.tabIndex=e),h.addClass(k).attr("tabIndex","-1"),c.addClass(f)):(e=a.tabIndex,void 0===e?h.removeAttr("tabIndex"):h.attr("tabIndex",e),h.removeClass(k),c.removeClass(f))};b.o.Cga=function(a){return"none"!=a.autoDismiss};b.o.XY=function(a,b){function e(){b();a.off("transitionend webkitTransitionEnd otransitionend oTransitionEnd",e)}a.on("transitionend webkitTransitionEnd otransitionend oTransitionEnd",
e)};b.o.LZ=function(a){b.o.V0(a);if(b.o.Cga(a)){var c=b.o.ri(a),e=a[b.o.kz]=function(e){var g=e.target;b.v.z3(e)||"focus"===e.type&&!f(g).is(":focusable")||b.v.Noa(c[0],g)||b.o.close(a)},g=document.documentElement;b.v.Qd()&&g.addEventListener("touchstart",e,!0);g.addEventListener("mousedown",e,!0);g.addEventListener("focus",e,!0)}b.o.LC(a)};b.o.V0=function(a){var c=a[b.o.kz];if(c){var e=document.documentElement;b.v.Qd()&&e.removeEventListener("touchstart",c,!0);e.removeEventListener("mousedown",c,
!0);e.removeEventListener("focus",c,!0);delete a[b.o.kz];a[b.o.kz]=null}b.o.rD(a)};b.o.LC=function(d){if(b.v.Qd()){var c=d[b.o.kv],e=f(c),g=b.o.NI(e),h,k;g===b.o.Zu&&!b.o.ce()||g===b.o.Yu&&b.o.ce()?(k={recognizers:[[a.Swipe,{direction:a.DIRECTION_LEFT}]]},h="swipeleft"):g===b.o.Zu&&b.o.ce()||g===b.o.Yu&&!b.o.ce()?(k={recognizers:[[a.Swipe,{direction:a.DIRECTION_RIGHT}]]},h="swiperight"):g===b.o.vP?(k={recognizers:[[a.Swipe,{direction:a.DIRECTION_UP}]]},h="swipeup"):g===b.o.aF&&(k={recognizers:[[a.Swipe,
{direction:a.DIRECTION_DOWN}]]},h="swipedown");e=e.al(k).on(h,function(a){a.preventDefault();b.o.close(d)});f.data(f(c)[0],b.o.MQ,{event:h,hammer:e})}};b.o.rD=function(a){a=b.o.ri(a);(a=f.data(a[0],b.o.MQ))&&a.hammer.off(a.event)};b.o.PS=function(a){var c=b.o.ri(a);if(f.data(c[0],b.o.cn)===a){b.o.NI(c);var e=b.o.sB(a);b.o.jD(a,e,!1);b.o.zja(a);b.o.V0(a);c.trigger("ojclose",a);f.removeData(c[0],b.o.cn)}};b.o.X_=function(a,c,e){var g=f(a);(c=!!c)&&b.o.Un(g)&&b.o.xl(a,!1);g.toggleClass(b.o.bca[e],!c)};
b.o.Mpa=function(a){var c=a.query;if(null!==c){var e=a[b.o.kv],c=window.matchMedia(c),g=b.o.q_(a);a=function(a){b.o.X_(e,a.matches,g)};c.addListener(a);b.o.X_(e,c.matches,g);f.data(f(e)[0],b.o.SF,{mqList:c,mqListener:a})}};o_("OffcanvasUtils.setupResponsive",b.o.Mpa,b);b.o.$pa=function(a){a=b.o.ri(a);var c=f.data(a[0],b.o.SF);c&&(c.mqList.removeListener(c.mqListener),f.removeData(a[0],b.o.SF))};o_("OffcanvasUtils.tearDownResponsive",b.o.$pa,b);b.o.open=function(a){var c=b.o.ri(a),e=f.data(c[0],b.o.cn);
if(e){if(e[b.o.Vu])return e[b.o.Vu];if(e[b.o.vF])return e[b.o.vF]}var e=new Promise(function(e,g){b.l.zd(c,jQuery);var l=b.o.q_(a),m=f.Event("ojbeforeopen");c.trigger(m,a);if(!1===m.result)g("ojbeforeopen veto");else{var n,m=b.o.bda(a),p=f.extend({},a);p[b.o.Wu]=m;f.data(c[0],b.o.cn,p);var r;r=b.o.sB(p);b.l.zd(r,jQuery);b.o.jD(p,r,!0);l===b.o.Zu||l===b.o.Yu?(n=void 0===n?c.outerWidth(!0)+"px":n,m===b.o.Xu&&b.o.ZC(r,l,n)):(n=void 0===n?c.outerHeight(!0)+"px":n,m===b.o.Xu&&b.o.Tka(r,l,n));var s;window.setTimeout(function(){s=
b.o.jt(c);b.l.zd(s,jQuery);s.addClass(b.o.BW(l))},10);b.o.j$(p,c);b.o.XY(r,function(){r.removeClass(b.o.Ym);b.rd.sy(c[0]);c.trigger("ojopen",p);b.o.LZ(p);e(!0)})}}),g=f.data(c[0],b.o.cn);g&&(g[b.o.vF]=e);return e};o_("OffcanvasUtils.open",b.o.open,b);b.o.close=function(a){return b.o.xl(a[b.o.kv],!0)};o_("OffcanvasUtils.close",b.o.close,b);b.o.xl=function(a,c){var e=f(a);b.l.zd(e,jQuery);var g=f.data(e[0],b.o.cn);if(g&&g[b.o.Vu])return g[b.o.Vu];var h=new Promise(function(h,l){if(b.o.Un(e)){a!=g[b.o.kv]&&
h(!0);var m=b.o.NI(e),n=g[b.o.Wu],m=b.o.BW(m),p=b.o.jt(e);b.l.zd(p,jQuery);p.hasClass(m)||h(!0);var r=f.Event("ojbeforeclose");e.trigger(r,g);if(!1===r.result)l("beforeClose veto");else{r=b.o.sB(g);if(c){var s=0,q=function(){b.o.PS(g);0!==s&&window.cancelAnimationFrame(s);h(!0)},t=function(){null==e[0].offsetParent?q():s=window.requestAnimationFrame(t)};b.o.XY(r,q);s=window.requestAnimationFrame(t)}n===b.o.Xu&&b.o.GL(r,"");p.removeClass(m);b.o.oK(g)&&g[b.o.lz].removeClass(b.o.CP);c?r.addClass(b.o.Ym):
(b.o.PS(g),h(!0))}}else h(!0)});(g=f.data(e[0],b.o.cn))&&(g[b.o.Vu]=h);return h};b.o.toggle=function(a){var c=b.o.ri(a);b.l.zd(c,jQuery);return b.o.Un(c)?b.o.close(a):b.o.open(a)};o_("OffcanvasUtils.toggle",b.o.toggle,b);b.o.I9=function(a){var c=f("\x3cdiv\x3e");c.addClass(b.o.Z5);c.attr("role","presentation");c.attr("aria-hidden","true");c.appendTo(a.parent());c.on("keydown keyup keypress mousedown mouseup mouseover mouseout click focusin focus",function(a){a.stopPropagation();a.preventDefault()});
return c};b.o.RH=function(a){var c=f("\x3cscript\x3e"),e=a.attr("id");e?(e=[e,"surrogate"].join("_"),c.attr("id",e)):e=c.uniqueId();c.insertBefore(a);a.attr(b.o.yF,e);return c};b.o.sla=function(a,c){a[b.o.hQ]=b.o.RH(c);c.appendTo(c.parent())};b.o.Zja=function(a){var c=b.o.ri(a);a=a[b.o.hQ];c&&a&&c.attr(b.o.yF)===a.attr("id")&&(c.insertAfter(a),c.removeAttr(b.o.yF),a.remove())};b.o.j$=function(a,c){b.o.oK(a)&&(a[b.o.lz]=b.o.I9(c),b.o.sla(a,c),window.setTimeout(function(){a[b.o.lz].addClass(b.o.CP)},
0))};b.o.zja=function(a){b.o.oK(a)&&(a[b.o.lz].remove(),b.o.Zja(a))};b.o.Z4=function(d){var c,e,g,h,k,l,m,n,p,r,s,q;null==f(d).attr("oj-data-pansetup")&&(f(d).attr("oj-data-pansetup","true"),d.displayMode="push",c=b.o.ri(d),e=d.size,null==e&&(e=c.outerWidth()),g=b.o.jt(c),h=b.o.sB(d),k={recognizers:[[a.Pan,{direction:a.DIRECTION_HORIZONTAL}]]},l=!1,f(g).al(k).on("panstart",function(e){m=null;switch(e.gesture.direction){case a.DIRECTION_LEFT:Math.abs(e.gesture.deltaY)<Math.abs(e.gesture.deltaX)&&(m=
b.o.ce()?"end":"start");break;case a.DIRECTION_RIGHT:Math.abs(e.gesture.deltaY)<Math.abs(e.gesture.deltaX)&&(m=b.o.ce()?"start":"end")}null!=m&&(n={direction:m,distance:Math.abs(e.gesture.deltaX)},p=f.Event("ojpanstart"),c.trigger(p,n),p.isDefaultPrevented()||(d._closePromise=null,b.o.jD(d,h,!0),l=!0,e.stopPropagation()))}).on("panmove",function(a){l&&(r=Math.abs(a.gesture.deltaX),c.css("width",r),h.removeClass(b.o.Ym),b.o.ZC(h,"start",a.gesture.deltaX+"px"),n={direction:m,distance:r},p=f.Event("ojpanmove"),
c.trigger(p,n),a.stopPropagation())}).on("panend",function(a){l&&(l=!1,r=Math.abs(a.gesture.deltaX),n={distance:r},p=f.Event("ojpanend"),c.trigger(p,n),a.stopPropagation(),p.isDefaultPrevented()?(q=function(){b.o.jD(d,h,!1);h.removeClass(b.o.Ym);h.off("transitionend webkitTransitionEnd otransitionend oTransitionEnd",q)},h.on("transitionend webkitTransitionEnd otransitionend oTransitionEnd",q),h.addClass(b.o.Ym),b.o.ZC(h,"start","0px")):(h.addClass(b.o.Ym),c.css("width",e+"px"),s=d.edge,null==s&&(s=
c.hasClass("oj-offcanvas-start")?"start":"end"),b.o.ZC(h,s,e+"px"),f.data(c[0],b.o.cn,d),f.data(c[0],b.o.RF,s),b.o.LZ(d)))}))};o_("OffcanvasUtils.setupPanToReveal",b.o.Z4,b);b.o.m5=function(a){a=b.o.ri(a);f(b.o.jt(a)).off("panstart panmove panend")};o_("OffcanvasUtils.tearDownPanToReveal",b.o.m5,b)});